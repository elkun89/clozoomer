<!DOCTYPE html>

<!-- <html>
{% load staticfiles %}
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="{% static "css/style.css" %}" type="text/css" media="screen"/>
<script src="{% static "js/jquery.js" %}"></script>
<script src="{% static "js/functions.js" %}" ></script>
<script src="{% static "js/highlight.js" %}"></script>
</head> -->

<html lang="en">
{% load staticfiles %}
	<head>
		<title>Clozoom</title>
		<meta charset="utf-8">
		<link rel="stylesheet" href="{% static "css/theme.css" %}" type="text/css" media="screen"/>
		<script src="{% static "js/jquery.js" %}"></script>
		<!-- <script src="{% static "js/functions.js" %}" ></script> -->
		<script src="{% static "js/highlight.js" %}"></script>
		<!-- Author: Kun Peng -->
	</head>

<script>

// function request() {
// 	$.getJSON('http://130.215.126.187:8000/rest/brands/?format=json', function(data) {
// 		var item = '';

// 		window.alert('hello');

// 		for(i = 0; i < data.length; i++){
// 			if(jQuery.inArray(data[i].id, itemIDs) == -1 && data[i].title != null){
// 				item = '<a target="_blank" href="'+ data[i].link +'"><div id="item"><p id="source">' + data[i].source + '</p><p id="title">' +data[i].title + '</p><p id="date">' + data[i].date + '</p></p><hr/></a>';
// 				itemIDs.push(data[i].id);


// 				$(item).insertAfter("#top").hide().fadeIn("slow");
// 			}
// 		}
// 	});

// 	if(query != 'new'){ $('p').highlight(query); }
// }

// function query_get(){    
// 	var querystr = window.location.href.split("?q=");   
// 	return querystr[1];   
// }


function show_livefeed(){
	var insert = '<div class = "newsfeed"><p>Your friend just bought a shoe at Nike:</p><img src = "{% static "images/feed1.jpg" %}" HEIGHT="138" WIDTH="220" BORDER="1"></div><div class = "newsfeed"><p>Your friend just bought a skirt:</p><img src = "{% static "images/feed2.jpg" %}" HEIGHT="200" WIDTH="138" BORDER="1"></div><div class = "newsfeed"><p>Your friend just posted 2 new pictures with the clothes that she purchased at XXX on 06/15/2012 via facebook:</p><img src = "{% static "images/feed3.jpg" %}" HEIGHT="200" WIDTH="138" BORDER="1"><img src = "{% static "images/feed3a.jpg" %}"><img src = "{% static "images/feed3b.jpg" %}"><img src = "{% static "images/feed3c.jpg" %}"></div>';
	$("#main_board").html(insert);
}

function getTypeData(id){	
	var insert = "";
	var apparelData;
	$.ajax({
		type: 'GET',
		url: '/getApparelType/' + id + '/',
		async : false,
		contentType: "application/json",
		success: function(data) {
			apparelData = data;
			// insert = insert + "Name: " + apparelName + "<br>";
			// $("#apparelType").append(insert);
		},
		error: function(e) {
			alert('error!');
		}
	});
	return apparelData;
};

function getLocationName(id){	
	var insert = "";
	var locationName;
	$.ajax({
		type: 'GET',
		url: 'rest/locations/' + id + '/',
		async : false,
		contentType: "application/json",
		success: function(data) {
			locationName = data.address;
		},
		error: function(e) {
		}
	});
	return locationName;
};

function apparel_request(){
	var clear = '';
	$("#main_board").html(clear);
	$.ajax({
		type: 'GET',
		url: '/apparel',
		contentType: "application/json",
		success: function(data) {
			var apparelName;
			var locationName;
			var insert = "List of User's Apparel: <br>";
			for (var i = 0; i < data.length; i++) {
				apparelName = getTypeData(data[i].type).name;
				locationName = getLocationName(data[i].locationOfPurchase);	
				insert = insert + "Name: " + apparelName + "<br>";
			    insert = insert + "Purchase Time: " + data[i].timeOfCreation + "<br>";
			    insert = insert + "Location: " + locationName + "<br>";

			    // $("#apparel").append($("apparelType"), $(apparelInstance));
			    // $("#apparelType").clear;
			    // $("#apparelInstance").clear;
			}
			$("#main_board").html(insert);
		},
		error: function(e) {
		}
	});
};

function category_request(){
	$.ajax({
		type: 'GET',
		url: '/categories',
		contentType: "application/json",
		success: function(data) {
			var insert = '';
			for (var i = 0; i < data.length; i++) {
			    insert = insert + data[i].name + "<br>";
			}
			$("#categories").html(insert);
		},
		error: function(e) {
		}
	});
};

function friends_request(){
	var clear = '';
	$("#main_board").html(clear);
	$.ajax({
		type: 'GET',
		url: '/getFriends',
		contentType: "application/json",
		success: function(data) {
			var insert = 'Friends: <br>';
			for (var i = 0; i < data.length; i++) {
			    insert = insert + "Name: " + data[i].first_name + " " + data[i].last_name + "<br>";
			    insert = insert + "Email: " + data[i].email + "<br>";
			}
			$("#main_board").html(insert);
		},
		error: function(e) {
			alert('error!');
		}
	});
};

function profile_request(){
	$.ajax({
		type: 'GET',
		url: '/userProfile',
		contentType: "application/json",
		success: function(data) {
			var insert = 'Profile: <br>';
			for (var i = 0; i < data.length; i++) {
			    insert = insert + "Username: " + data[i].username + "<br>";
			    insert = insert + "Email: " + data[i].email + "<br>";
			}
			$("#profile").html(insert);
		},
		error: function(e) {
		}
	});
}

function apparel_nojson_request(){
	var clear = '';
	$("#main_board").html(clear);
	var insert = '{% for a in usrApparel %}Name : {{a.type.name}} <br>Time Added to Closet: {{a.timeOfCreation}} <br>Location of Purchase : {{a.locationOfPurchase.address}}<br><br>{% endfor %}';
	$("#main_board").html(insert);
}

function show_profilepic(){
	var clear = '';
	$("#profilepic_photo").html(clear);

	$.ajax({
		type: 'GET',
		url: 'getFriends',
		contentType: "application/json",
		success: function(data) {
			alert(data[0].email);
			var insert = '';
			insert = insert + '<img src = "../static/images/';
			insert = insert + data[0].profilePictureLink;
			insert = insert + '" HEIGHT="200" WIDTH="138" BORDER="1">';
			$("#profilepic_photo").html(insert);
		},
		error: function(e) {
			alert(e);
		}
	});

}

$(document).ready(function(){
	show_livefeed();
	//show_profilepic();
	//profile_request(); 
	// $("#clear").click(function(){
	// 	var clear = '';
	// 	$("#apparel").html(clear);
	// 	$("#categories").html(clear);
	// 	$("#profile").html(clear);
	// });
});

</script>

	<body>
		<div id = "leftpart">
			<section id="profilepic_section">
				<div id = 'profilepic_photo'>
<<<<<<< HEAD
					<img src = "{{thisProfile.profilePictureLink.url}}" HEIGHT="200" WIDTH="138" BORDER="1">
					<!-- <img src = "{{thisProfile.profilePictureLink}}"> -->
=======
					<!--<img src = "{% static "images/profilepic.jpg" %}" HEIGHT="200" WIDTH="138" BORDER="1"> -->
					<img src = {{MEDIA_URL}}{{thisProfile.profilePictureLink}}>
>>>>>>> aa5016d38a0fbef7e8c90127915820d30556fc52
				</div>
				<p>{{thisUser.first_name}} {{thisUser.last_name}}</p>
				<p>Edit Profile</p>
			</section>
		
			<section id="sidebar">
				<h4>Current Trends</h4>
				<p> XXX </p>
				<p> XXX </p>
				<p> XXX </p>
				<br />
				<br />
				<br />
				<h4>Followed Trends</h4>
				<p> XXX </p>
				<p> XXX </p>
				<p> XXX </p>
			</section>
		</div>
		
		<div id = "rightpart">
			<section id="main_content">
				<div>
					<menu id = "thumbnails">
                                            <ul>
						<li><input class = "button" type="button" onclick="show_livefeed();" value="Stream" /></li>
						<li><input class = "button" type="button" onclick="apparel_nojson_request();" value="Closet" /></li>
						<li><input class = "button" type="button" onclick="friends_request();" value="Followers" /></li>
						<li><a class = "button" href="/editProfile">Edit Profile</a></li>
						<li><a class = "button" href="/accounts/logout/">Log Out</a></li>
                                            </ul>
				</div>
				<div id = "main_board" >
				</div>
				<div id = "test_board" >
				</div>
			</section>
		</div>
	</body>
</html>

